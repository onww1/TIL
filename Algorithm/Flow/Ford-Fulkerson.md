# Ford-Fulkerson Algorithm

## 유량 그래프 성질

1. **각 간선에 흐르는 유량은 그 간선의 용량을 넘어서는 안 된다.** 
   $f(u, v) \le c(u, v)$

2. S와 T를 제외한 정점에서는 **들어오는 유량 총합과 나가는 유량 총합이 같아야 한다.**
   **$\sum f(k, u) = \sum f(u, l)$**
   $\sum f(S, k) = \sum f(k, T)$

3. 간선 $u \to v$ 방향으로 유량이 흐르고 있다면, **역방향으로는 음의 유량이 그만큼 흐르고 있는 것으로 취급한다.**
   $f(u, v) = -f(v, u)$

   

## 포트 풀커슨 알고리즘 : 동작 원리

1. $S$에서 $T$로 가는 **`증가 경로 (augmenting path)`**를 아무거나 하나 찾는다.
   이때, 증가 경로는 단순 경로이고, 경로상의 모든 간선에 아직 **`여유 용량 (residual)`**이 남아있다.

   `c(u, v) - f(u, v) > 0`

2. 증가 경로 중 **`차단 간선 (blocking edge)`**을 찾는다.
   이 간선은 경로 상에서 `c(u, v) - f(u, v)` 값이 최소인 간선이다.
   많아봐야 이만큼만 유량을 더 보낼 수 있을 것이다. 이 값을 `F`라 하자.

3. 경로 상의 모든 간선에 `F`만큼의 유량을 추가한다.
   즉, $S$에서 $T$로 이 경로를 따라서 `F`만큼의 유량을 새로 흘려보낸 것이다.
   경로상의 모든 간선에 대해 `f(u, v) +=  F`
   그런데  세 번째 성질을 만족시키기 위해  `f(v, u) -= F` 또한 행해야 한다. 
   **역방향으로는 상응하는 음의 유량을 흘려주는 것이다.**

#### **$\to$ 더 이상 증가 경로가 없을 때까지 반복**



## 포드 풀커슨 알고리즘 : 시간 복잡도

- 증가 경로를 찾는 방법 : **DFS** $\to$  $O(V + E)$
- 문제의 답이 `f`라고 할 때, 증가 경로를 찾는 횟수는 최대 `f`번 $\to$ $O(f)$ 

#### $\therefore$ $O((V + E)f)$ $\to$ $O(Ef)$



## 포드 풀커슨 문제점 보완

* 증가 경로를 DFS가 아닌 **BFS**로 찾아서, $S$에서 $T$로 가는 가장 짧은 경로를 찾아내는 방식을 사용
  $\to$ **$O(VE^2)$**

  ##### **: 에드몬드 카프 알고리즘 (Edmonds-Karp Algorithm)**

  